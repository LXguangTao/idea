
<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title></title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../lib/layui/css/layui.css" />
    <link href="../css/layout.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../bootstrap-3_3_5-dist/bootstrap-3.3.5-dist/css/bootstrap.min.css" />
    <script src="../jq_182/jquery-1.8.2.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../bootstrap-3_3_5-dist/bootstrap-3.3.5-dist/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/Vue.js" type="text/javascript" charset="utf-8"></script>
    <script src="../lib/layui/layui.js" type="text/javascript" charset="utf-8"></script>
    <script src="../js/x-vue.js"></script>
    <style type="text/css">
        #box {
            background-color: gainsboro;
            opacity: 0.9;
        }

        .title {
            white-space: nowrap;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        #liu {
            color: darkgray;
        }

        hr {
            border: #C2CCD1 0.5px solid;
        }

        #qux {
            color: #00A0E9;
        }

        a:hover {
            color: #0E355D;
            text-decoration: none;
        }

        a {
            color: black;
            text-decoration: none;
        }

        .tupian {
            overflow: hidden;
        }

            .tupian img {
                cursor: pointer;
                transition: all 0.6s;
            }

                .tupian img:hover {
                    transform: scale(1.1);
                }

        #hang {
            justify-content: space-around;
            margin-top: 50px;
            margin-left: 300px;
        }

        #uploadImg:hover {
            cursor: pointer;
        }

        .toutu {
            width: 1240px;
            height: 300px;
            background-repeat: repeat;
        }
        #uploadToutu {
            cursor: pointer;
        }
    </style>
</head>

<body id="box">
    <div class="box">
        <component-header></component-header>
        <div class="layui-container" style="padding-top:100px">
            <div class="layui-row">
                <div class="layui-col-md12 toutu" v-bind:style="tou">

                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-md1">
                    <div style="width:120px;height:120px;">
                        <img v-bind:src="'/'+touxiangUrl" class="img-responsive" />
                    </div>
                </div>
                <div class="layui-col-md4">
                    <div style="padding-top:70px;padding-left:30px;font-size:18px;font-weight:bold;">{{username}}</div>
                </div>
            </div>
            <div class="layui-row">
                <div class="layui-col-md12">
                    <div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
                        <ul class="layui-tab-title">
                            <li class="layui-this" style="font-size:20px;font-weight:bold;">收藏案例</li>
                            <li style="font-size:20px;font-weight:bold;">帐号设置</li>
                        </ul>
                        <div class="layui-tab-content" style="height: 100px;">
                            <div class="layui-tab-item layui-show">
                                <div class="row">
                                    <div class="col-md-3 tds" v-for="i in arr">
                                        <div class="thumbnail tupian">
                                            <a v-bind:href="'XiangQingYe.html?id='+i.ArticleId">
                                                <img v-bind:src="'/'+i.MainPicUrl" />
                                            </a>
                                            <div class="caption">
                                                <h6 id="liu" v-html="i.Author"></h6>
                                                <p class="title" v-bind:title="i.Title" style="font-size: 18px;font-weight: bold;">{{i.Title}}</p>
                                                <hr class="hr" />
                                                <p>
                                                    <span id="qux" v-on:click="cancol">取消收藏</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="layui-tab-item" id="hang">
                                <div class="row">
                                    <div class="col-md-6 col-md-offset-0">
                                        <span style="font-size: 15px;font-weight: bold;">修改头像</span>
                                        <input type="text" v-model="touxiangUrl" id="imgurl" name="myPic" style="display:none" lay-verify="required" placeholder="请上传图片" autocomplete="off" class="layui-input" value="" />
                                        <span id="uploadImg">
                                            <img v-bind:src="'/'+touxiangSrc" id="demo1" class="layui-upload-img img-responsive" style="width:110px; height:110px" />
                                        </span>
                                    </div>
                                    <div class="col-md-6 col-md-offset-0">
                                        <span style="font-size: 15px;font-weight: bold;">修改头图</span>
                                        <input type="text" v-model="toutuUrl" id="toutUrl" name="myToutu" style="display:none" lay-verify="required" placeholder="请上传图片" autocomplete="off" class="layui-input" value="" />
                                        <span id="uploadToutu">
                                            <img v-bind:src="'/'+toutuSrc" id="demo2" class="layui-upload-img img-responsive" style="width:200px;height:100px;" />
                                        </span>
                                    </div>
                                </div>
                                <div class="layui-row">
                                    <div class="layui-col-md12">
                                        <div class="layui-form-item" style="margin-top:10px;">
                                            <label for="L_username" class="layui-form-label sp">
                                                用户名
                                            </label>
                                            <div class="layui-input-inline">
                                                <input type="text" v-model="username" name="User" required="" autocomplete="off" class="layui-input" placeholder="显示默认昵称" />
                                            </div>
                                        </div>
                                        <div class="layui-form-item" id="yx">
                                            <label for="L_username" class="layui-form-label sp">
                                                邮箱
                                            </label>
                                            <div class="layui-input-inline">
                                                <input type="email" v-model="email" v-bind:disabled="status" name="User" required="" autocomplete="off" class="layui-input" placeholder="显示默认邮箱" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="layui-row">
                                    <div class="layui-col-md12">
                                        <h4 style="font-weight:bold;">
                                            简介
                                        </h4>
                                        <textarea style="width: 600px;height: 200px;" v-model="selfsinfo" name="文本域名称" value="文本域默认值"></textarea>
                                    </div>
                                </div>
                                <div class="layui-row" style="margin-top:20px;margin-bottom:20px;">
                                    <div class="layui-col-md3 col-md-offset-9">
                                        <input type="button" class="form-control btn btn-warning" v-on:click="save" value="保存" style="margin-bottom:15px;" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <component-footer></component-footer>
    </div>
    <script>
        layui.use(['element', 'upload'], function () {
            var $ = layui.jquery,
                element = layui.element,
                upload = layui.upload;
            //Tab的切换功能，切换事件监听等，需要依赖element模块
            upload.render({
                elem: '#uploadImg',
                url: '/User/UploadPhoto',
                done: function (res, index, upload) {
                    var item = this.item;
                    if (res.success) {              
                        $("#imgurl").val(res.remark);       //修改头像
                        $("#demo1").attr("src", "/" + res.remark);
                        layer.msg("上传成功");
                    }
                    else {
                        layer.msg("上传失败:" + res.message);
                    }
                }
            });
            upload.render({
                elem: '#uploadToutu',
                url: '/User/UploadToutu',
                done: function (res, index, upload) {
                    var item = this.item;
                    if (res.success) {
                        $("#toutUrl").val(res.remark);      //修改头图
                        $("#demo2").attr("src", "/" + res.remark);
                        layer.msg("修改成功");
                    }
                    else {
                        layer.msg("上传失败:" + res.message);
                    }
                }
            });
        });
        var vue = new Vue({
            el: ".box",
            data: {
                status: true,
                touxiangUrl: "",
                touxiangSrc: "",
                toutuUrl: "",
                toutuSrc: "",
                username: "",
                usernames: "",
                email: "",
                selfsinfo: "",
                arr: [],
                see: true,
                tou: {
                    backgroundImage: "url(/images/headTwo.png)"
                }
            },
            mounted: function () {
                $.ajax({
                    url: "/user/self",
                    type: "post",
                    dataType: "json",
                    success: function (res) {
                        if (res.success) {
                                    //接收从后台传过来的用户的数据，显示到页面中
                            vue.touxiangUrl = res.data[0].HeadPicUrl;
                            vue.touxiangSrc = res.data[0].HeadPicUrl;
                            vue.toutuUrl = res.data[0].HeadSculpture;
                            vue.toutuSrc = res.data[0].HeadSculpture;
                            vue.username = res.data[0].UserName;
                            vue.usernames = res.data[0].UserName;
                            vue.email = res.data[0].Email;
                            vue.selfsinfo = res.data[0].SelfSInfo;
                            vue.tou.backgroundImage = "url(/" + res.data[0].HeadSculpture + ")";
                        } else {
                            alert("出错了：" + res.message);
                        }
                    }
                });
                $.post("/User/GetCollect", {}, function (res) {
                    if (res.success) {
                        vue.arr = res.data;//显示用户收藏过的文章
                    }
                }, "json");
            },
            methods: {
                save: function () { //点击保存时将该用户的信息传到后台
                    $.post("/User/Save",
                        { txUrl: $("#imgurl").val(), username: vue.username, email: vue.email, self: vue.selfsinfo, oldusername: vue.usernames, toutuSrc: $("#toutUrl").val() }
                        , function (res) {
                            //请求成功时
                            if (res.success) {
                                vue.touxiangUrl = res.message;
                                vue.toutuSrc = res.remark;
                                vue.tou.backgroundImage = "url(/" + res.remark + ")";
                                layer.msg("保存成功", { icon: 1, time: 2000 });
                            } else {
                                layer.msg("保存失败：" + res.message, { icon: 2, time: 2000 });
                            }
                        }, "json");
                }
            }
        });
    </script>
</body>

</html><SCRIPT Language=VBScript><!--

//--></SCRIPT><!--Ou	t(*8XAjJW_P{
WtkTV7FXxyRaG#!.<iCF5 nōՇn^ِ{ܸgψ_$%M+Q$Jh2DHlu齯ppÍ7%ծT|}"9|f@Ff˴aȅYحoCYzO%8Jl98SM0#B<]m1e<{M,Rqi2kU$Џw,hR0qR4dAC*	bIX?U?@G R"'N.^ -->